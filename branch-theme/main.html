{% extends "base.html" %}

<!-- Analytic scripts -->
{% block analytics %}

{{ super() }}

  <script id="Cookiebot" src="https://consent.cookiebot.com/uc.js" data-cbid="7b71d939-6959-42f9-832a-f4237fe8e243" async></script>
  {% if config.extra.sources.google %}
    <style>.async-hide{opacity:0!important}</style>
    <script data-cookieconsent="marketing" type="text/plain">(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date; h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')}; (a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c; })(window,document.documentElement,'async-hide','dataLayer',1000, {'{{ config.extra.sources.google.optimize }}':true});</script>
  {% endif %}
  {% if config.extra.sources.mixpanel %}
    <script data-cookieconsent="marketing" type="text/plain">(function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments, 0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" "); for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]); mixpanel.init("{{ config.extra.sources.mixpanel }}");</script>
  {% endif %}
  {% if config.extra.sources.google %}
    <script data-cookieconsent="marketing" type="text/plain">
      // Cookie helper functions
      function getCookie(name) {
        var value = "; " + document.cookie;
        var parts = value.split("; " + name + "=");
        if (parts.length >= 2) return parts.pop().split(";").shift();
      }
      function setCookie(name, value, expires_days) {
        var d = new Date();
        d = new Date(d.getTime() + 1000*60*60*24 * expires_days);
        document.cookie = name + '=' + value + '; expires=' + d.toGMTString() + '; path=/; domain=.branch.io';
      }
      var returning_visitor = getCookie('bnc_returning_visitor'); // Cookie will have a value of '1' if user has been seen before, or won't exist if not
      var page_url = window.location.host + window.location.pathname; // Page URL for first time visitor attribution
      setCookie('bnc_returning_visitor', "1", 30); // Extend first time visitor attribution window to 30 days from current visit
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', '{{ config.extra.sources.google.analytics }}', 'auto');
      ga('require', '{{ config.extra.sources.google.optimize }}');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
      ga('require', 'linkid', 'linkid.js');
      // Set initial landing page URL for first time visitors
      if (!returning_visitor) {
        ga('set', 'dimension1', page_url );
      }
    </script>
  {% endif %}
  {% if config.extra.sources.facebook %}
    <script data-cookieconsent="marketing" type="text/plain">
      !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
      n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
      document,'script','https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', '{{ config.extra.sources.facebook }}');
      fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id={{ config.extra.sources.facebook }}&ev=PageView&noscript=1"></noscript>
  {% endif %}
  {% if config.extra.sources.linkedin %}
    <script data-cookieconsent="marketing" type="text/plain">
      _linkedin_data_partner_id = "{{ config.extra.sources.linkedin }}";
      (function() {var s = document.getElementsByTagName("script")[0]; var b = document.createElement("script"); b.type = "text/javascript";b.async = true; b.src = "https://snap.licdn.com/li.lms-analytics/insight.min.js"; s.parentNode.insertBefore(b, s);} )();
    </script>
  {% endif %}
  {% if config.extra.sources.bizible %}
    <script data-cookieconsent="marketing" type="text/plain" src="//cdn.bizible.com/scripts/bizible.js" async></script>
  {% endif %}
  {% if config.extra.sources.munchkin %}
    <script data-cookieconsent="marketing" type="text/plain">
      (function() {
        var didInit = false;
        function initMunchkin() {
          if (didInit === false) {
            didInit = true;
            Munchkin.init('{{ config.extra.sources.munchkin }}', { domainLevel: 2 });
          }
        }
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.async = true;
        s.src = '//munchkin.marketo.net/munchkin.js';
        s.onreadystatechange = function() {
          if (this.readyState == 'complete' || this.readyState == 'loaded') {
            initMunchkin();
          }
        };
        s.onload = initMunchkin;
        document.getElementsByTagName('head')[0].appendChild(s);
      })();
    </script>
  {% endif %}
  {% if config.extra.sources.algolia %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css">
  {% endif %}

  <link rel="alternate" hreflang="en-US" href="{{config.site_url}}">
  <link rel="alternate" hreflang="en" href="{{config.site_url}}/">
  <link rel="alternate" hreflang="ko" href="{{config.site_url}}/ko/">
  <link rel="alternate" hreflang="ja" href="{{config.site_url}}/ja/">
  <link rel="alternate" hreflang="zh" href="{{config.site_url}}/zh/">
{% endblock %}

<!-- Theme-related JavaScript -->
{% block scripts %}

  {{ super() }}

  {% if config.extra.sources.algolia %}
    <script src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script>
    <script>docsearch({
      appId:"{{ config.extra.sources.algolia.appId }}",
      apiKey:"{{ config.extra.sources.algolia.apiKey }}",
      indexName:"{{ config.extra.sources.algolia.index }}",
      inputSelector:"{{ config.extra.sources.algolia.selector }}",
      {% if config.extra.sources.algolia.debug == true %}
        debug:"{{ config.extra.sources.algolia.debug }}",
      {% endif %}
      algoliaOptions:{hitsPerPage:"{{ config.extra.sources.algolia.hits }}", facetFilters: ["lang:/"]}})</script>
  {% endif %}

{% endblock %}
